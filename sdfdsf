
Private Sub UserForm1_Initialize()

Dim ColCnt As Integer
Dim rng As Range
Dim cno As String
Dim c As Integer

ColCnt = ActiveSheet.UsedRange.Column.Count
Set rng = ActiveSheet.UsedRange

With ListBox1
    .ColumnCount = ColCnt
    .RowSource = rng.Address
    cw = ""
    For c = 1 To .ColumnCount
        cw = cw & rng.Columns(c).Width & ";"
    Next c
    .ColumnWidths = cw
    .ListIndex = 0
    End With

End Sub
